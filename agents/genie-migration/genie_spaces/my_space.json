{
  "_metadata": {
    "exported_at": "2025-12-22T20:20:51.573398+00:00",
    "source_space_id": "01f070c3397d14b49986083aca54f0c2",
    "source_workspace": "https://adb-984752964297111.11.azuredatabricks.net",
    "export_version": "1.0"
  },
  "title": "dhuang SEC Financial Data Genie",
  "description": "Analysis of balance sheet and income statement data for APPL, BAC, and AXP, from years 2003 through 2022.",
  "serialized_space": "{\n  \"version\": 1,\n  \"data_sources\": {\n    \"tables\": [\n      {\n        \"identifier\": \"users.david_huang.balance_sheet\",\n        \"column_configs\": [\n          {\n            \"column_name\": \"ACCOUNTS_PAYABLES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"ACCUMULATED_OTHER_COMPREHENSIVE_INCOME\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"CALENDAR_YEAR\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"CAPITAL_LEASE_OBLIGATIONS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"CASH_AND_EQUIVALENTS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"CASH_AND_SHORT_TERM_INVESTMENTS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"COMMON_STOCK\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"DEFERRED_REVENUE\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"DEFERRED_REVENUE_NONCURRENT\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"DEFERRED_TAX_LIABILITIES_NONCURRENT\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"GOODWILL\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"GOOD_WILL_AND_INTANGIBLE_ASSETS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"INTANGIBLE_ASSETS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"INVENTORY\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"LONG_TERM_DEBT\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"LONG_TERM_INVESTMENTS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"MINORITY_INTEREST\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"NET_DEBT\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"NET_RECEIVABLES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_ASSETS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_CURRENT_ASSETS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_CURRENT_LIABILITIES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_LIABILITIES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_NONCURRENT_LIABILITIES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_NON_CURRENT_ASSETS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_TOTAL_STOCKHOLDERS_EQUITY\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"PERIOD\",\n            \"get_example_values\": true,\n            \"build_value_dictionary\": true\n          },\n          {\n            \"column_name\": \"PREFERRED_STOCK\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"PROPERTY_PLANT_EQUIPMENTNET\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"RETAINED_EARNINGS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"SHORT_TERM_DEBT\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"SHORT_TERM_INVESTMENTS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TAX_ASSETS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TAX_PAYABLES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TICKER\",\n            \"get_example_values\": true,\n            \"build_value_dictionary\": true\n          },\n          {\n            \"column_name\": \"TOTAL_ASSETS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_CURRENT_ASSETS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_CURRENT_LIABILITIES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_DEBT\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_EQUITY\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_INVESTMENTS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_LIABILITIES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_LIABILITIES_AND_STOCKHOLDERS_EQUITY\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_LIABILITIES_AND_TOTAL_EQUITY\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_NONCURRENT_LIABILITIES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_NON_CURRENT_ASSETS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TOTAL_STOCKHOLDERS_EQUITY\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"YEAR\",\n            \"get_example_values\": true\n          }\n        ]\n      },\n      {\n        \"identifier\": \"users.david_huang.income_statement\",\n        \"column_configs\": [\n          {\n            \"column_name\": \"ACCOUNTS_PAYABLES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"ACCOUNTS_RECEIVABLES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"ACQUISITIONS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"CALENDAR_YEAR\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"CAPITAL_EXPENDITURE\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"CHANGE_IN_WORKING_CAPITAL\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"COMMON_STOCK_ISSUED\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"COMMON_STOCK_REPURCHASED\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"DEBT_PAYMENT\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"DEFERRED_INCOME_TAX\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"DEPRECIATION_AND_AMORTIZATION\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"DIVIDENDS_PAID\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"FOREX_CHANGE\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"FREE_CASH_FLOW\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"INVENTORY\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"INVESTMENTS_IN_PROPERTY_PLANT_AND_EQUIPMENT\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"NET_CHANGE_IN_CASH\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"NET_FINANCING_ACTIVITIES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"NET_INCOME\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"NET_INVESTING_ACTIVITES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"NET_OPERATING_ACTIVITIES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OPERATING_CASH_FLOW\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_FINANCING_ACTIVITES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_INVESTING_ACTIVITES\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_NON_CASH_ITEMS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"OTHER_WORKING_CAPITAL\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"PERIOD\",\n            \"get_example_values\": true,\n            \"build_value_dictionary\": true\n          },\n          {\n            \"column_name\": \"PURCHASES_OF_INVESTMENTS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"SALES_OF_INVESTMENTS\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"STOCK_BASED_COMPENSATION\",\n            \"get_example_values\": true\n          },\n          {\n            \"column_name\": \"TICKER\",\n            \"get_example_values\": true,\n            \"build_value_dictionary\": true\n          },\n          {\n            \"column_name\": \"YEAR\",\n            \"get_example_values\": true\n          }\n        ]\n      }\n    ]\n  },\n  \"instructions\": {\n    \"text_instructions\": [\n      {\n        \"id\": \"01f07138b6841a3a89aa2f8d6ebd470c\",\n        \"content\": [\n          \"# Guidelines\\n\",\n          \"1. **Fully qualify** each column with its table alias (`bs`, `is`, `cf`, etc.).\\n\",\n          \"2. **Filter** by `company_id` (ticker) and explicit period(s) given by the user.\\n\",\n          \"3. If the user omits **time period, filing type, or company**, respond with exactly **one** follow-up question that asks for the missing detail, then stop.\\n\",\n          \"4. Use `ROUND(metric_value, 4)` for ratio outputs unless the user requests raw numbers.\\n\",\n          \"5. Default sort order: descending by fiscal_year, fiscal_quarter.\\n\",\n          \"6. Ensure divisions use `NULLIF(denominator,0)` to avoid divide-by-zero errors.\\n\",\n          \"7. For multi-period comparisons (e.g., YoY), use CTEs or self-joins that clearly label current vs. prior periods (`cur`, `prev`).\\n\",\n          \"\\n\",\n          \"# SUPPORTED METRICS & RATIOS\\n\",\n          \"- Liquidity\\n\",\n          \"    * Current Ratio: bs.total_current_assets / bs.total_current_liabilities\\n\",\n          \"    * Quick Ratio: (bs.cash_and_equivalents + bs.short_term_investments + bs.accounts_receivable) / bs.total_current_liabilities\\n\",\n          \"- Solvency\\n\",\n          \"    * Debt-to-Equity: (bs.short_term_debt + bs.long_term_debt) / bs.shareholders_equity\\n\",\n          \"    * Interest Coverage: is.ebit / NULLIF(is.interest_expense,0)\\n\",\n          \"- Profitability\\n\",\n          \"    * Gross Margin: (is.gross_profit / is.total_revenue)\\n\",\n          \"    * Net Profit Margin: is.net_income / is.total_revenue\\n\",\n          \"    * Return on Assets (ROA): is.net_income / bs.total_assets\\n\",\n          \"    * Return on Equity (ROE): is.net_income / bs.shareholders_equity\\n\",\n          \"- Efficiency\\n\",\n          \"    * Asset Turnover: is.total_revenue / bs.total_assets\\n\",\n          \"- Growth\\n\",\n          \"    * Revenue Growth % YoY: (cur.total_revenue - prev.total_revenue) / prev.total_revenue\\n\",\n          \"- Cash Flow\\n\",\n          \"    * Free Cash Flow: cf.operating_cash_flow - cf.capital_expenditure\\n\",\n          \"\\n\",\n          \"Remember: you are a precise, no-nonsense financial analyst SQL generator. Ask clarifying questions only when essential information is missing; otherwise, return the optimized SQL query immediately.\"\n        ]\n      }\n    ],\n    \"example_question_sqls\": [\n      {\n        \"id\": \"01f071388fa0197bbbbc4fb3fd7c7398\",\n        \"question\": [\n          \"What is the debt to equity ratio for APPL for 2022\"\n        ],\n        \"sql\": [\n          \"SELECT\\n\",\n          \"    ROUND(\\n\",\n          \"        try_divide((`short_term_debt` + `long_term_debt`), NULLIF(`total_equity`, 0)), 4\\n\",\n          \"    ) AS `debt_to_equity_ratio`\\n\",\n          \"FROM\\n\",\n          \"    `users`.`david_huang`.`balance_sheet`\\n\",\n          \"WHERE\\n\",\n          \"    `TICKER` = :company\\n\",\n          \"    AND `YEAR` = :year\\n\",\n          \";\"\n        ],\n        \"parameters\": [\n          {\n            \"name\": \"company\",\n            \"type_hint\": \"STRING\",\n            \"default_value\": {\n              \"values\": [\n                \"AAPL\"\n              ]\n            }\n          },\n          {\n            \"name\": \"year\",\n            \"type_hint\": \"STRING\",\n            \"default_value\": {\n              \"values\": [\n                \"2021\"\n              ]\n            }\n          }\n        ]\n      },\n      {\n        \"id\": \"01f095ac3e30190ba72e8149bd6ab271\",\n        \"question\": [\n          \"Compare asset turnover between company_1 and company_2 over all times\"\n        ],\n        \"sql\": [\n          \"SELECT\\n\",\n          \"  bs.TICKER,\\n\",\n          \"  bs.YEAR,\\n\",\n          \"  ROUND(TRY_DIVIDE(is.NET_INCOME, NULLIF(bs.TOTAL_ASSETS, 0)), 4) AS net_income_turnover\\n\",\n          \"FROM\\n\",\n          \"  users.david_huang.balance_sheet bs\\n\",\n          \"    JOIN users.david_huang.income_statement is\\n\",\n          \"      ON bs.TICKER = is.TICKER\\n\",\n          \"      AND bs.YEAR = is.YEAR\\n\",\n          \"WHERE\\n\",\n          \"  bs.TICKER IN (:company_1,  :company_2)\\n\",\n          \"  AND bs.PERIOD = 'FY'\\n\",\n          \"  AND is.PERIOD = 'FY'\\n\",\n          \"  AND is.NET_INCOME IS NOT NULL\\n\",\n          \"  AND bs.TOTAL_ASSETS IS NOT NULL\\n\",\n          \"ORDER BY\\n\",\n          \"  bs.TICKER,\\n\",\n          \"  bs.YEAR\"\n        ],\n        \"parameters\": [\n          {\n            \"name\": \"company_1\",\n            \"type_hint\": \"STRING\",\n            \"default_value\": {\n              \"values\": [\n                \"AAPL\"\n              ]\n            }\n          },\n          {\n            \"name\": \"company_2\",\n            \"type_hint\": \"STRING\",\n            \"default_value\": {\n              \"values\": [\n                \"AXP\"\n              ]\n            }\n          }\n        ]\n      },\n      {\n        \"id\": \"01f098a114eb10e085e96b5be6e5858a\",\n        \"question\": [\n          \"what was BofA's net income growth over the last 10 years?\"\n        ],\n        \"sql\": [\n          \"WITH ordered AS (\\n\",\n          \"  SELECT\\n\",\n          \"    is.YEAR,\\n\",\n          \"    is.NET_INCOME\\n\",\n          \"  FROM\\n\",\n          \"    users.david_huang.income_statement is\\n\",\n          \"  WHERE\\n\",\n          \"    is.TICKER = 'BAC'\\n\",\n          \"    AND is.PERIOD = 'FY'\\n\",\n          \"    AND is.NET_INCOME IS NOT NULL\\n\",\n          \"  ORDER BY\\n\",\n          \"    is.YEAR\\n\",\n          \"),\\n\",\n          \"with_growth AS (\\n\",\n          \"  SELECT\\n\",\n          \"    YEAR,\\n\",\n          \"    NET_INCOME,\\n\",\n          \"    LAG(NET_INCOME, 1) OVER (ORDER BY YEAR) AS prev_net_income\\n\",\n          \"  FROM\\n\",\n          \"    ordered\\n\",\n          \")\\n\",\n          \"SELECT\\n\",\n          \"  YEAR,\\n\",\n          \"  ROUND(\\n\",\n          \"    TRY_DIVIDE(NET_INCOME - prev_net_income, NULLIF(prev_net_income, 0)) * 100, 4\\n\",\n          \"  ) AS net_income_growth_pct\\n\",\n          \"FROM\\n\",\n          \"  with_growth\\n\",\n          \"WHERE\\n\",\n          \"  prev_net_income IS NOT NULL\\n\",\n          \"ORDER BY\\n\",\n          \"  YEAR DESC\\n\",\n          \"LIMIT 10;\"\n        ]\n      },\n      {\n        \"id\": \"01f098cc968217d08ecab33124ef65ab\",\n        \"question\": [\n          \"What is the forecast of Apple's annual net income until 2030?\"\n        ],\n        \"sql\": [\n          \"SELECT * FROM AI_FORECAST(\\n\",\n          \"  TABLE(select NET_INCOME, to_date(concat(YEAR, '-12-31')) AS YEAR_END_DATE from users.david_huang.income_statement where ticker = :TICKER),\\n\",\n          \"  horizon => '2031',\\n\",\n          \"  time_col => 'YEAR_END_DATE',\\n\",\n          \"  value_col => 'NET_INCOME'\\n\",\n          \") \"\n        ],\n        \"parameters\": [\n          {\n            \"name\": \"TICKER\",\n            \"type_hint\": \"STRING\",\n            \"default_value\": {\n              \"values\": [\n                \"AAPL\"\n              ]\n            }\n          }\n        ]\n      }\n    ],\n    \"join_specs\": [\n      {\n        \"id\": \"01f095aa36901cef9433ce3c0d57440b\",\n        \"left\": {\n          \"identifier\": \"users.david_huang.balance_sheet\",\n          \"alias\": \"balance_sheet\"\n        },\n        \"right\": {\n          \"identifier\": \"users.david_huang.income_statement\",\n          \"alias\": \"income_statement\"\n        },\n        \"sql\": [\n          \"`balance_sheet`.`TICKER` = `income_statement`.`TICKER`\",\n          \"--rt=FROM_RELATIONSHIP_TYPE_ONE_TO_ONE--\"\n        ]\n      },\n      {\n        \"id\": \"01f095aa40be1c9987883b63b371d70f\",\n        \"left\": {\n          \"identifier\": \"users.david_huang.balance_sheet\",\n          \"alias\": \"balance_sheet\"\n        },\n        \"right\": {\n          \"identifier\": \"users.david_huang.income_statement\",\n          \"alias\": \"income_statement_2\"\n        },\n        \"sql\": [\n          \"`balance_sheet`.`YEAR` = `income_statement_2`.`YEAR`\",\n          \"--rt=FROM_RELATIONSHIP_TYPE_ONE_TO_ONE--\"\n        ]\n      }\n    ]\n  }\n}\n"
}